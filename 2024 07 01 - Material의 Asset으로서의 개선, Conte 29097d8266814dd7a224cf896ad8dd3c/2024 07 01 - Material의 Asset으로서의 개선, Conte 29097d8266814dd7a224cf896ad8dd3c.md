# 2024/07/01 - Materialì˜ Assetìœ¼ë¡œì„œì˜ ê°œì„ , Content UI / Outliner UI ì œì‘(1)

íƒœê·¸: C++, DirectX11, ê·¸ë˜í”½ìŠ¤, ì¤‘ê¸‰
ë‚ ì§œ: 2024/07/01
ìƒìœ„ í•­ëª©: Week32 (https://www.notion.so/Week32-ba138587ed0c43049aaeb6a6d6683658?pvs=21)
ìƒíƒœ: ì™„ë£Œ
ì£¼ì°¨: 0100_Week30~39

> 1êµì‹œ ë…¹ìŒë³¸
> 
> 
> - [https://clovanote.naver.com/s/4Y4tFErU3MzXVScei3uojFS](https://clovanote.naver.com/s/4Y4tFErU3MzXVScei3uojFS)
> 
> 2êµì‹œ ë…¹ìŒë³¸
> - [https://clovanote.naver.com/s/R7kbXYkHr5KCivx94mJM3iS](https://clovanote.naver.com/s/R7kbXYkHr5KCivx94mJM3iS)
> 

## Materialì˜ Assetìœ¼ë¡œì„œì˜ ê°œì„ 

ê°ì²´ë“¤ì´ ë™ì¼í•œ Materialì´ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì€

- ê°™ì€ ì‰ì´ë”ë¥¼ ì‚¬ìš©
- í•„ìš”í•œ Constê°’, Textureë“¤(ì¦‰, ì„¸íŒ… ê°’)ì„ ë™ì¼í•˜ê²Œ ë°”ì¸ë”© í•´ ì‚¬ìš©

ë”°ë¼ì„œ ì‰ì´ë”ë¥¼ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ë”ë¼ë„, ë‹¤ì–‘í•œ ì¬ì§ˆ í‘œí˜„ì„ ìœ„í•´ì„œ í•´ë‹¹ ì‰ì´ë”ì— ì ‘ëª©ë˜ëŠ” ì¬ì§ˆì€ ë‹¤ì–‘í•  ìˆ˜ ìˆë‹¤

í˜„ì¬ ìƒí™©ì—ì„œëŠ” *[í•˜ë‚˜ì˜ Shader - í•˜ë‚˜ì˜ Material]*ì„ ì—°ê²°í•´ ë†“ê³  ì‚¬ìš©í–ˆì§€ë§Œ, 

ì‹¤ ì‚¬ìš©ì—ì„œëŠ” í•˜ë‚˜ì˜ ì‰ì´ë”ì— ì „ë‹¬í•  ì¸ìë¥¼ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— Materialì˜ ìˆ˜ê°€ ì–´ë§ˆì–´ë§ˆí•˜ê²Œ ë§ì•„ì§€ê²Œ ëœë‹¤!

ë”°ë¼ì„œ ìš°ë¦¬ê°€ í˜„ì¬ ì œì‘í•œ Editorë¥¼ í™œìš©í•´ Materialì„ ì œì‘í•˜ê³ , ì €ì¥í•˜ê³ , ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆê²Œë” ê°œì„ ì´ ë˜ì–´ì•¼ í•œë‹¤

ê·¸ë¦¬ê³  ë˜ ë‹¤ë¥¸ ì´ì•¼ê¸°!

Materialë„ Assetì˜ ê°œë…ìœ¼ë¡œ í¬í•¨ì‹œì¼°ê¸° ë•Œë¬¸ì— ë‹¹ì—°í•˜ê²Œë„ ê³µìœ ë˜ëŠ” ìì›ì´ê³ , 

ì—¬ëŸ¬ Objectë“¤ì€ í•˜ë‚˜ì˜ Materialì„ ì±„íƒí•´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤

ë§Œì•½ 3ê°œì˜ ì˜¤ë¸Œì íŠ¸ê°€ *í•˜ë‚˜ì˜ Material*ì„ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•´ë³´ì

â†’ ê·¸ëŸ¼ 3ê°œì˜ ì˜¤ë¸Œì íŠ¸ëŠ” ë™ì¼í•œ ì‰ì´ë”, ë™ì¼í•œ ìƒìˆ˜ ë°ì´í„°, ë™ì¼í•œ í…ìŠ¤ì³ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤

ì´ë•Œ, í•˜ë‚˜ì˜ ì˜¤ë¸Œì íŠ¸ë§Œ ì–´ë–¤ ì¡°ê±´ì—ì„œ íŠ¹ë³„í•œ íš¨ê³¼ê°€ ì ìš©ë˜ì–´ì•¼ í•œë‹¤ë©´?

í•´ë‹¹ ì˜¤ë¸Œì íŠ¸ê°€ ì°¸ì¡°í•˜ê³  ìˆëŠ” Materialì˜ ì–´ë–¤ ë°ì´í„°ë¥¼ íš¨ê³¼ë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ì„œ ë³€ê²½í•˜ê²Œ ëœë‹¤ë©´ 3ê°œì˜ ì˜¤ë¸Œì íŠ¸ ëª¨ë‘ ë™ì¼í•œ íš¨ê³¼ê°€ ì ìš©ë˜ë©° ì˜ë„í•œ ë°”ì™€ ë‹¬ë¼ì§€ê²Œ ëœë‹¤!

ì›ë˜ Materialì„ ì œì‘í•  ë•Œì—ëŠ”, ì´ë ‡ê²Œ ì—¬ëŸ¬ Objectê°€ ë³¸ì¸ì„ ì°¸ì¡°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì¼ë°˜ì ì¸ ìƒí™©ì—ì„œëŠ” ì„¸íŒ… ê°’ì´ ë³€í•˜ì§€ ì•ŠëŠ” ê°€ì •í•˜ì— ì œì‘ëœë‹¤

ê·¸ëŸ¼ ì´ëŸ° ìƒí™©ì„ ì–´ë–»ê²Œ ê°œì„ í•  ìˆ˜ ìˆì„ê¹Œ?

â†’ ì˜¤ë¸Œì íŠ¸ë‹¹ ì‚¬ìš©í•˜ëŠ” ì¬ì§ˆì„ í•˜ë‚˜ì”© ì „ë‹¬í•˜ê¸°

- ì¥ì  : ê°€ì¥ ë‹¨ìˆœí•œ í•´ê²° ë°©ë²•
- ë‹¨ì  : ì¬ì§ˆì„ Asset ê°œë…ìœ¼ë¡œ ê³µìœ í•´ì„œ ì“°ëŠ” ì˜ì˜ê°€ ì—†ìŒ, ë©”ëª¨ë¦¬ ë° ì„±ëŠ¥ ìµœì í™” (Instancing) í˜ë“¬

<aside>
âœï¸ **Instancing(ì¸ìŠ¤í„´ì‹±)ì— ëŒ€í•˜ì—¬**

ë™ì¼í•œ Mesh, ë™ì¼í•œ Materialì„ ì‚¬ìš©í•˜ëŠ” ì˜¤ë¸Œì íŠ¸ë“¤ì„ ì—¬ëŸ¬ê°œ ê·¸ë ¤ì¤˜ì•¼ í•  ë•Œ, 
(ì¦‰ ë°”ì¸ë”©ì‹œí‚¬ ë¦¬ì†ŒìŠ¤ë“¤, ì‰ì´ë”ê°€ ë™ì¼í•  ë•Œì—) ì—¬ëŸ¬ ì˜¤ë¸Œì íŠ¸ì˜ ì‚¬ìš©ë˜ëŠ” ë¦¬ì†ŒìŠ¤ë“¤ì„ ë‹¨ì¼ì ìœ¼ë¡œ ë°”ì¸ë”©ì‹œí‚¤ë©´ì„œ í•œë²ˆì— ê·¸ë¦¬ëŠ” ê²ƒì„ Instancingì´ë¼ê³  í•œë‹¤

[Instancingì´ ê°€ëŠ¥í•œ ì¡°ê±´]

- ë™ì¼í•œ Meshë¥¼ ì°¸ì¡°í•˜ê³  ìˆëŠ” ì˜¤ë¸Œì íŠ¸ë“¤
- ë™ì¼í•œ Materialì„ ì°¸ì¡°í•˜ê³  ìˆëŠ” ì˜¤ë¸Œì íŠ¸ë“¤
- ë™ì¼í•œ Shaderë¥¼ ì°¸ì¡°í•˜ê³  ìˆëŠ” ì˜¤ë¸Œì íŠ¸ë“¤

Instancingì„ í†µí•´ ì‰ì´ë”ì—ê²Œ ì œê³µí•´ì•¼ í•˜ëŠ” ë°ì´í„°ì˜ ì–‘ì„ ì¤„ì„ìœ¼ë¡œì¨ ì„±ëŠ¥ì„ í¬ê²Œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤ â†’ ìš°ë¦¬ê°€ Materialì„ Assetìœ¼ë¡œ ì œì‘í•œ ì´ìœ ì´ê¸°ë„ í•˜ë‹¤!

![Untitled](2024%2007%2001%20-%20Material%E1%84%8B%E1%85%B4%20Asset%E1%84%8B%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A5%E1%84%8B%E1%85%B4%20%E1%84%80%E1%85%A2%E1%84%89%E1%85%A5%E1%86%AB,%20Conte%2029097d8266814dd7a224cf896ad8dd3c/Untitled.png)

</aside>

Instancingì˜ ì´ì ì„ ìµœëŒ€í•œ ë†“ì§€ ì•Šìœ¼ë©´ì„œë„, ê°œë³„ì ìœ¼ë¡œ Objectì— íŠ¹ìˆ˜í•œ íš¨ê³¼ì˜ Materialì´ ì ìš©ë  ìˆ˜ ìˆê²Œë” *ë™ì  ì¬ì§ˆ (Dynamic Material)*ì„ ì‚¬ìš©í•  ê²ƒì´ë‹¤!

ì¦‰, í˜„ì¬ Materialì˜ ê°œì„ ì„ ìœ„í•´ì„œ í•´ì•¼í•  ì¼ë“¤ì„ ì •ë¦¬í•˜ìë©´

- Materialì˜ Assetìœ¼ë¡œì¨ì˜ ì´ì ì„ ìœ ì§€í•˜ë©´ì„œ ê°œë³„ì ìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆë„ë¡ Dynamic Material êµ¬í˜„
- Materialì˜ Save / Load ê¸°ëŠ¥ êµ¬í˜„

### Dynamic Material (ë™ì  ì¬ì§ˆ)

ì´ì œë¶€í„° RenderComponentì—ì„œëŠ”, Material ì´ 3ê°œë¥¼ ìš´ì˜í•  ê²ƒì´ë‹¤

```cpp
class CRenderComponent :
	public CComponent
{
private:
	Ptr<CMesh>         m_Mesh;
	
	Ptr<CMaterial>     m_Mtrl;               // í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ ì¬ì§ˆ
	Ptr<CMaterial>     m_SharedMtrl;         // ê³µìœ  ì¬ì§ˆ(master)
	Ptr<CMaterial>     m_DynamicMtrl;        // ì„ì‹œ ì¬ì§ˆ
	
	// ...
}
```

ë‹¤ë£¨ëŠ” Materialì´ ë‹¤ì–‘í•´ì§„ë§Œí¼, Get/Set ì—­ì‹œ ë‹¤ì–‘í•´ì§„ë‹¤

**Shared Material, Dynamic Materialì˜ Get/Setê³¼ ê·¸ì— ëŒ€í•œ êµ¬í˜„**

```cpp
class CRenderComponent:
	public CComponent
{
// ...
public :
	// í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ Materialì„ Get (ê¸°ë³¸ì ìœ¼ë¡œ Materialì„ Getí•  ë•Œ ì‚¬ìš©)
	Ptr<CMaterial> GetMaterial() { return m_Mtrl; }

	// ê³µìœ  Materialì˜ Get/Set
	void SetMaterial(Ptr<CMaterial> _Mtrl);
	Ptr<CMaterial> GetSharedMtrl();
	
	// ë™ì  Materialì˜ ìƒì„± ë° ë°˜í™˜ ë‹´ë‹¹
	Ptr<CMaterial> GetDynamicMaterial();
}
```

```cpp
void CRenderComponent::SetMaterial(Ptr<CMaterial> _Mtrl)
{
	// ê¸°ë³¸ì ìœ¼ë¡œ ì„¸íŒ…ë˜ëŠ” Materialì€ Shared Mtrl
	m_Mtrl = m_SharedMtrl = _Mtrl;
}

Ptr<CMaterial> CRenderComponent::GetSharedMtrl()
{
	m_Mtrl = m_SharedMtrl;
	return m_Mtrl;
}

Ptr<CMaterial> CRenderComponent::GetDynamicMaterial()
{
	assert(CLevelMgr::GetInst()->GetCurrentLevel()->GetState() == LEVEL_STATE::PLAY);

	// ì´ë¯¸ Dynamic Materialì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°
	if (m_DynamicMtrl != nullptr)
		return m_Mtrl = m_DynamicMtrl;
	
	// Shared Materialì™€ ë™ì¼í•œ ì„¸íŒ…ì´ì§€ë§Œ ë³¸ì¸ë§Œì´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Dynamic Materialì„ ìƒì„±
	m_Mtrl = m_DynamicMtrl = m_SharedMtrl->Clone();
	
	return m_Mtrl;		
}
```

- ë™ì  ì¬ì§ˆì˜ ìƒì„± ë° ë°˜í™˜, ì¦‰ `GetDynamicMaterial()`ëŠ” ê²Œì„ì´ Play ì¤‘ì¸ ìƒí™©ì—ì„œë§Œ í˜¸ì¶œë  ê²ƒ â†’ assert ì¡°ê±´ ì„¤ì •
- `GetDynamicMaterial()`ì„ í†µí•´ì„œ, Shared Materialì˜ ê¸°ë³¸ì ì¸ ì„¸íŒ…ê°’ì„ ê°€ì ¸ì˜¤ë©´ì„œë„ ë³¸ì¸ë§Œì˜ íŠ¹ìˆ˜í•œ íš¨ê³¼ë¥¼ ì ìš©í•  ìˆ˜ ìˆëŠ” ì „ìš© ì¬ì§ˆì¸ Dynamic Materialì„ ìƒì„±í•¨ê³¼ ë™ì‹œì— ì´ë¥¼ ë°˜í™˜ë°›ì•„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤!
    - ì´ë•Œ, ì´ë¯¸ ì œì‘í•œ DynamicMtrlì´ ì¡´ì¬í•  ê²½ìš° ê¸°ì¡´ì— ì œì‘í–ˆë˜ Dynamic Materialì´ í˜„ì¬ ì‚¬ìš©ë˜ëŠ” ì¬ì§ˆë¡œ ì„¤ì •ë˜ë„ë¡ ì˜ˆì™¸ ì²˜ë¦¬
    

<aside>
ğŸ—’ï¸ [ìˆ˜ì • ì‚¬í•­]
ì¬ì§ˆ ìª½ì—ë„ Cloneì„ ì¶”ê°€

â†’ ì ìš©ë  *ë³µì‚¬ìƒì„±ì*ì— ëŒ€í•´ì„œ ê³ ë ¤í•´ë³´ì•˜ì„ ë•Œ,

- ë¶€ëª¨ì¸ CAsset í´ë˜ìŠ¤ â†’ ë³µì‚¬ ìƒì„±ì êµ¬í˜„ ì™„ë£Œ
- ë³¸ì¸ì¸ CMaterial í´ë˜ìŠ¤ â†’ ê¸°ë³¸ ë³µì‚¬ìƒì„±ìë¥¼ ì‚¬ìš©í•´ë„ ë¬´ê´€

ë”°ë¼ì„œ Materialì—ì„œëŠ” ì¶”ê°€ì ìœ¼ë¡œ ë³µì‚¬ìƒì„±ìë¥¼ êµ¬í˜„í•´ì£¼ì§€ ì•Šì•˜ë‹¤

```cpp
class CMaterial :
	public CAsset
{
	// ...
public:
	CLONE(CMaterial);
	CMaterial();
	~CMaterial();
};
```

</aside>

ìŒ.. ê·¸ëŸ¬ë‚˜ DirectXë¥¼ 2Dë¡œ ì‚¬ìš©í•˜ëŠ” ë•Œì— í•œì •í•´ì„œ, Instancingì„ ë³¸ê²©ì ìœ¼ë¡œ ì ìš©í•˜ëŠ” ì‘ì—…ì€ ì§„í–‰í•˜ì§€ ì•Šì„ ê²ƒì´ë‹¤!

â†’ ì•„ì§ê¹Œì§€ëŠ” ì´ ìµœì í™”ë¥¼ ì ìš©í•¨ìœ¼ë¡œì¨ ì´ì ì„ í¬ê²Œ ì–»ì„ ìˆœ ì—†ê¸° ë•Œë¬¸ì—â€¦

ë”°ë¼ì„œ ê° ì˜¤ë¸Œì íŠ¸ê°€ í•˜ë‚˜ì˜ Materialì„ ì‚¬ìš©í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ,

ê° Objectê°€ ê°€ì§„ Scriptì˜ Beginì—ì„œ, ê³§ë°”ë¡œ Dynamic Materialì„ ì–»ì–´ì˜´ìœ¼ë¡œì¨ Objectë“¤ì€ ì„¤ì •ëœ Shared Materialì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ê°ê°ì˜ ì¬ì§ˆì„ ì œì‘í•´ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤

```cpp
class CPlayerScript :
 public CScript
{
	// ...
public:
	virtual void Begin() override;
	virtual void Tick() override;
	// ...
}
```

```cpp
void CPlayerScript::Begin()
{
	GetRenderComponent()->GetDynamicMaterial();
}
```

<aside>
ğŸ—’ï¸ [ìˆ˜ì • ì‚¬í•­]

ë¶€ëª¨ í´ë˜ìŠ¤ì¸ Scriptì—ì„œ GetRenderComponentí•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±í•´,

ê° Objectì˜ RenderComponentë¥¼ ìì‹ë“¤ì´ ì‰½ê²Œ Getí•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•´ë‘ì

```cpp
class CScript :
	public CComponent
{
public:
	CRenderComponent* GetRenderComponent { return GetOwner()->GetRenderComponent(); }
}
```

</aside>

### Materialì˜ Save / Load

ë¨¼ì € Materialì˜ ë©¤ë²„ë“¤ ì¤‘, ìš°ë¦¬ê°€ íŒŒì¼ë¡œ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¬ ë§Œí•œ ì •ë³´ë“¤ì— ëŒ€í•´ ê³ ë ¤í•´ë³´ì

- m_Shader â†’ ì–´ë–¤ ì‰ì´ë”ë¥¼ ì°¸ì¡°í•˜ëŠ”ì§€
- m_Const â†’ Materialì´ ì‚¬ìš©í•˜ëŠ” ìƒìˆ˜ ë°ì´í„°
- m_arrTex â†’ ì‚¬ìš©í•˜ëŠ” Textureë“¤

í•œ Materialì— ëŒ€í•´ ë‹¤ìŒ ì •ë³´ë“¤ì„ ëª¨ë‘ Save, Loadí•˜ëŠ” ê¸°ëŠ¥ì„ ì œì‘í•´ë³´ì

**Materialì˜ Save/Load ì œì‘**

```cpp
class CMaterial :
	public CAsset
{
	// ...
public:
	virtual int Save(const wstring& _RelativePath) override; // ì™œ ìƒëŒ€ ê²½ë¡œë¡œ?
	virtual int Load(const wstring& _FilePath) override;
};
```

```cpp
int CMaterial::Save(const wstring& _RelativePath)
{
	wstring strFilePath = CPathMgr::GetInst()->GetContentPath();
	strFilePath += _RelativePath;
	
	FILE File = nullptr;
	_wfopen_s(&File, strFilePath.c_str(), L"wb");
	
	// ì–´ë–¤ ì‰ì´ë”ë¥¼ ì°¸ì¡°í–ˆëŠ”ì§€
	SaveAssetRef(m_Shader, File);
	
	// ìƒìˆ˜ ë°ì´í„°
	fwrite(&m_Const, sizeof(tMtrlConst), 1, File);
	
	// ì°¸ì¡°í•œ Textureë“¤
	for(UINT i = 0; i < TEX_PARAM::END; ++i)
	{
		SaveAssetRef(m_arrTex[i], File);
	}
	
	fclose(File);
	
	return S_OK;
}

int CMaterial::Load(const wstring& _FilePath)
{
	FILE* File = nullptr;
	_wfopen_s(&File, _FilePath.c_str(), L"rb");
	
	if (nullptr == File)
		return E_FAIL;
		
	// ì–´ë–¤ ì‰ì´ë”ë¥¼ ì°¸ì¡°í–ˆëŠ”ì§€
	LoadAssetRef(m_Shader, File);
	
	// ìƒìˆ˜ ë°ì´í„°
	fread(&m_Const, sizeof(tMtrlConst), 1, File);
	
	// ì°¸ì¡°í•œ Textureë“¤
	for (UINT i = 0; i < TEX_PARAM::END; ++i)
	{
		LoadAssetRef(m_arrTex[i], File);
	}
	
	fclose(File);
	
	return S_OK;
}
```

- `SaveAssetRef`, `LoadAssetRef` í™œìš©

ì´ë ‡ê²Œ ì‘ì„±í•œ Save / Loadë¥¼ í™œìš©í•´ Materialì„ ì €ì¥í•´ë³´ê³  ë¶ˆëŸ¬ì™€ ì ìš©í•´ë³´ì

**Materialì˜ Save**

ì„ì‹œì ìœ¼ë¡œ, Level Managerì—ì„œ Init ë‹¨ê³„ì—ì„œ Beginë˜ê¸° ì§ì „ì— ì œì‘í•œ Materialì„ Save

```cpp
void CLevelMgr::Init()
{
	// ...
	pMtrl->Save(L"material\\std2d.mtrl");
	
	m_CurLevel->Begin();
}
```

![Untitled](2024%2007%2001%20-%20Material%E1%84%8B%E1%85%B4%20Asset%E1%84%8B%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A5%E1%84%8B%E1%85%B4%20%E1%84%80%E1%85%A2%E1%84%89%E1%85%A5%E1%86%AB,%20Conte%2029097d8266814dd7a224cf896ad8dd3c/Untitled%201.png)

â†’ content í´ë”ì— materialí´ë”ë¥¼ ìƒˆë¡­ê²Œ ì œì‘í•´ì„œ, mtrl í™•ì¥ìë¡œ Materailì˜ ì •ë³´ë“¤ì„ ì €ì¥í•´ì¤¬ë‹¤

**Materialì˜ Load**

```cpp
void CAssetMgr::CreateEngineMaterial()
{
	// ...
	// Std2DMtrl
	pMtrl = new CMaterial();
	pMtrl->Load(CPathMgr::GetInst()->GetContentPath() + L"material\\std2d.mtrl");
	AddAsset(L"Std2DMtrl", pMtrl);
	// ...
}
```

â†’ ê¸°ì¡´ì— ì§ì ‘ ì œì‘í•¨ìœ¼ë¡œì¨ ì„¤ì •í–ˆë˜ Materialì„, íŒŒì¼ë¡œ Loadí•´ì„œ ì ìš©í•´ì¤¬ë‹¤!

ì•ìœ¼ë¡œëŠ” ì—¬ê¸°ì„œ ë” ë‚˜ì•„ê°€ì„œ, Level ìì²´ë¥¼ ì €ì¥í•˜ê±°ë‚˜ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤

â†’ Level ì•ˆì— ìˆë˜ Objectë¶€í„°, í•´ë‹¹ ì˜¤ë¸Œì íŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” Component, ì°¸ì¡°í•˜ëŠ” Assetë“¤â€¦

ê·¸ë¦¬ê³  í•´ë‹¹ Levelì„ ë¶ˆëŸ¬ì˜¨ë‹¤ë©´, ì €ì¥í–ˆë˜ ìƒíƒœ ê·¸ëŒ€ë¡œ Levelì„ ë°°í¬í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤

ê·¸ë¦¬ê³  ì´ë ‡ê²Œ Save / Load í•˜ëŠ” ê³¼ì •ì„ ì†ìˆ˜ í•˜ë“œ ì½”ë”©ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼,

UIë¥¼ í†µí•´ì„œ ì§„í–‰ì´ ë  ìˆ˜ ìˆë„ë¡ â†’ ContentUI, OutlinerUI ì„¤ê³„ í•„ìš”

## Content UI / Outliner UI ì œì‘ (1)

### Content UI

ë¨¼ì €, Content UIì˜ êµ¬ì„±ì€ Content ë³„ë¡œ íƒ€ì…ì´ ë‚˜ë‰˜ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì—, íƒ€ì…ë³„ë¡œ íƒ­ì´ ë‚˜ë‰˜ë„ë¡ *TreeNode*ë¥¼ í™œìš©í•˜ë ¤ í•œë‹¤

ê·¸ëŸ¬ë‚˜ ImGuiì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” TreeNodeì˜ í˜•ì‹ì€, ì•„ë˜ ì˜ˆì‹œì²˜ëŸ¼ ê°€ë³€ì ì¸ ëŒ€ì‘ì´ ë¶ˆê°€ëŠ¥í•˜ê³  íƒ­ ë³„ë¡œ êµ¬í˜„í•˜ë ¤ëŠ” êµ¬ì¡°ê°€ í™•ì‹¤í•  ë•Œ ìœ ìš©í•˜ê¸° ë•Œë¬¸ì— â€¦

ì˜ˆì‹œ)

![Untitled](2024%2007%2001%20-%20Material%E1%84%8B%E1%85%B4%20Asset%E1%84%8B%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A5%E1%84%8B%E1%85%B4%20%E1%84%80%E1%85%A2%E1%84%89%E1%85%A5%E1%86%AB,%20Conte%2029097d8266814dd7a224cf896ad8dd3c/Untitled%202.png)

```cpp
if (ImGui::TreeNodeEx("Parent"))
	{
		if (ImGui::TreeNodeEx("Child 1"))
		{
			if (ImGui::TreeNodeEx("Child 1's Child"))
			{
				
				ImGui::TreePop();
			}
			ImGui::TreePop();
		}
		
		if (ImGui::TreeNodeEx("Child 2"))
		{
			ImGui::TreePop();
		}
		ImGui::TreePop();
	}
```

ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê²ƒì€ ì‹¤ì œ Content í´ë”ì™€, ìš°ë¦¬ì˜ Asset Managerê°€ ë¡œë”©í•˜ê³  ìˆëŠ” Assetì„ ë„ìš°ëŠ” Content UIë¥¼ ë™ê¸°í™”ì‹œì¼œ, 

- ë§Œì•½ í”„ë¡œê·¸ë¨ì´ ëŸ°íƒ€ì„ ë„ì¤‘ì— ìƒˆë¡œìš´ í…ìŠ¤ì³ë¥¼ í¬í•¨í•œë‹¤ë©´ ë°”ë¡œ Content UIì— ëœ¨ë„ë¡
- í•´ë‹¹ ì›ë³¸ì´ ì‚­ì œë˜ë©´ Content UIì— ë¡œë”©ëœ ê²ƒë„ ì‚­ì œë˜ë„ë¡

í•˜ëŠ” ê¸°ëŠ¥ì„ ê°–ëŠ” Content UIë¥¼ êµ¬í˜„í•˜ê³  ì‹¶ì€ ê²ƒì´ë‹¤!

ë”°ë¼ì„œ ê°€ë³€ì ì¸ ëŒ€ì‘ì´ ê°€ëŠ¥í•œ TreeNode í˜•íƒœì˜ UIë¥¼ ì„¤ê³„í•´, Content UIë‚˜, Outliner UIì˜ ìì‹ìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆê²Œë” ë²”ìš©ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ë³´ì

â†’ ì¦‰, ìš°ë¦¬ë§Œì˜ ***Tree UI***ë¥¼ ì œì‘í•´ë³´ì!

### Tree UI

Tree UIëŠ”, ê³„ì¸µ êµ¬ì¡°ë¥¼ ê°–ê³  ìˆëŠ” Tree Nodeë¥¼ í™œìš©í•´ UIë¥¼ êµ¬ì„±í•  ê²ƒì´ê¸° ë–„ë¬¸ì—, ë‘ ê°€ì§€ì— ëŒ€í•œ í´ë˜ìŠ¤ë¥¼ ëª¨ë‘ ì„ ì–¸í•´ì¤¬ë‹¤

- `TreeNode` â†’ ë¶€ëª¨/ìì‹ì˜ ê³„ì¸µ êµ¬ì¡°ë¥¼ êµ¬ì„±í•˜ëŠ” ì£¼ì²´ê°€ ë˜ëŠ” Node
- `TreeUI` â†’ ê³„ì¸µì„ ì´ë£¨ëŠ” Tree Nodeë¥¼ í™œìš©í•´ UI ì •ë³´ë¥¼ Update í•  ìˆ˜ ìˆë„ë¡ Root Nodeë¥¼ ê°€ì§

```cpp
class TreeNode
{
private:
	string               m_Name;
	TreeNode*            m_ParentNode;
	vector<TreeNode*>    m_vecChildNode;
	
public:
	void SetName(const string& _Name) { m_Name = _Name; }
	const string& GetName() { return m_Name; }
	
	void AddChildNode(TreeNode* _Node) { m_vecChildNode.push_back(_Node); }
	
public:
	void Update();

public:
	TreeNode();
	~TreeNode();
};

class TreeUI :
 public EditorUI
{
private:
	TreeNode*    m_Root;

public:
	void AddNode(const string& _Name);            // Tree Nodeë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥

public:
	virtual void Update() override;
	
public:
	TreeUI();
	~TreeUI();
};
```

**TreeNodeì˜ êµ¬í˜„**

```cpp
TreeNode::TreeNode()
	: m_ParentNode(nullptr)
{
}

TreeNode::~TreeNode()
{
}

void TreeNode::Update()
{
	if (ImGui::TreeNodeEx(m_Nmae.c_str()))
	{
		for (size_t i = 0; i < m_vecChildNode.size(); ++i)
		{
			m_vecChildNode[i]->Update();
		}
		ImGui::TreePop();
	}
}
```

**TreeUIì˜ êµ¬í˜„**

```cpp
TreeUI::TreeUI()
	: m_Root(nullptr)
{
}

TreeUI::~TreeUI()
{
	if (m_Root != nullptr)
		delete m_Root;
}

void TreeUI::Update()
{
	if (m_Root == nullptr)
		return;
	
	m_Root->Update();
}

void TreeUI::AddNode(const string& _Name)
{
	TreeNode* pNode = new TreeNode;
	
	if (m_Root == nullptr)
	{
		m_Root = pNode;
	}
	
	pNode->SetName(_Name);
}
```

Test )

ê·¸ëŸ¼ Content UIì—ì„œ, ë°©ê¸ˆ ì œì‘í•œ Tree UIë¥¼ í™œìš©í•´ í•œë²ˆ ë…¸ë“œë¥¼ ì¶”ê°€í•˜ê³  ë„ì›Œë³´ì

```cpp
class Content :
	public EditorUI
{
private:
	 class TreeUI* m_Tree;

// ...
}
```

```cpp
Content::Content()
{
	m_Tree = new TreeUI;
	m_Tree->SetName("ContentTree");
	AddChild(m_Tree);
	
	m_Tree->AddNode("Parent");
}

void Content::Update()
{
	// Tree UIê°€ ë‚´ ìì‹ UIì´ë¯€ë¡œ, EditorUIì˜ Tickì—ì„œ Update ì§„í–‰
}
```

![Untitled](2024%2007%2001%20-%20Material%E1%84%8B%E1%85%B4%20Asset%E1%84%8B%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A5%E1%84%8B%E1%85%B4%20%E1%84%80%E1%85%A2%E1%84%89%E1%85%A5%E1%86%AB,%20Conte%2029097d8266814dd7a224cf896ad8dd3c/Untitled%203.png)